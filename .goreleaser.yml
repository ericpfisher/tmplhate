version: 2
project_name: tmplhate

# Cross-platform Go builds
builds:
  - goos:
      - linux
      - darwin
      - windows
    goarch:
      - amd64
      - arm64
    ldflags:
      - -X github.com/ericpfisher/tmplhate/cmd.Version={{.Version}}
      - -X github.com/ericpfisher/tmplhate/cmd.Commit={{.ShortCommit}}
      - -X github.com/ericpfisher/tmplhate/cmd.Date={{.Date}}
    env:
      - CGO_ENABLED=0

archives:
  - formats:
      - tar.gz
    files:
      - LICENSE

# Docker multi-arch build (default)
dockers_v2:
  - images:
      - ghcr.io/ericpfisher/tmplhate
    tags:
      - v{{ .Version }}
      - latest
    dockerfile: Dockerfile
    labels:
      "org.opencontainers.image.description": "tmplhate - Go template app"
      "org.opencontainers.image.created": "{{.Date}}"
      "org.opencontainers.image.name": "{{.ProjectName}}"
      "org.opencontainers.image.revision": "{{.FullCommit}}"
      "org.opencontainers.image.version": "{{.Version}}"
      "org.opencontainers.image.source": "{{.GitURL}}"

sboms:
  - id: default

# Release to GitHub
release:
  github:
    owner: ericpfisher
    name: tmplhate
  draft: false
  prerelease: false
